<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë°”ë¥´ì…€ë¡œë‚˜ ìœ ë‹ˆí¼ ì¶”ê°€</title>
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 20px;
        }
        .status {
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            font-weight: bold;
        }
        .status.loading {
            background: #fff3cd;
            color: #856404;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
        }
        button {
            background: #059669;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
        }
        button:hover {
            background: #047857;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”´ğŸ”µ ë°”ë¥´ì…€ë¡œë‚˜ 25/26 ìœ ë‹ˆí¼ ì¶”ê°€</h1>
        <div id="status" class="status loading">ì¤€ë¹„ ì¤‘...</div>
        <div id="details"></div>
        <button id="addButton" onclick="addProducts()" disabled>Firebaseì— ì¶”ê°€í•˜ê¸°</button>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js';
        import { getDatabase, ref, get, set } from 'https://www.gstatic.com/firebasejs/11.0.2/firebase-database.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBu7tXrbeWjp3h0Xt_mCTp4oswsuGMSGkw",
            authDomain: "omacasemiro-8fd4c.firebaseapp.com",
            databaseURL: "https://omacasemiro-8fd4c-default-rtdb.firebaseio.com",
            projectId: "omacasemiro-8fd4c",
            storageBucket: "omacasemiro-8fd4c.firebasestorage.app",
            messagingSenderId: "322343249421",
            appId: "1:322343249421:web:de70a69176f468d5d05744"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // ì¶”ê°€í•  ì œí’ˆ ë°ì´í„°
        const newProducts = [
            {
                model_code: "HJ4590",
                name: "FC Barcelona 2025/26 Stadium Home Jersey",
                team: "ë°”ë¥´ì…€ë¡œë‚˜",
                kit_type: "í™ˆí‚·",
                season: "25/26",
                version: "ë ˆí”Œë¦¬ì¹´",
                image: "https://thumblr.uniid.it/product/393279/0aa8d4376cb4.jpg",
                visible: true,
                site_offers: [
                    {
                        site_name: "Unisport",
                        regular_price: 99.95,
                        sale_price: 99.95,
                        discount_rate: 0,
                        currency: "EUR",
                        affiliate_link: "https://www.unisportstore.com/football-shirts/barcelona-home-shirt-202526/393279/"
                    },
                    {
                        site_name: "ì‹ ì„¸ê³„ë°±í™”ì ",
                        regular_price: 138000,
                        sale_price: 126960,
                        discount_rate: 8,
                        currency: "KRW",
                        sale_price_krw: 126960,
                        affiliate_link: "https://department.ssg.com/search.ssg?query=%EB%B0%94%EB%A5%B4%EC%85%80%EB%A1%9C%EB%82%98%EC%9C%A0%EB%8B%88%ED%8F%BC"
                    }
                ]
            },
            {
                model_code: "HJ4554",
                name: "FC Barcelona 2025/26 Kobe Away Jersey",
                team: "ë°”ë¥´ì…€ë¡œë‚˜",
                kit_type: "ì–´ì›¨ì´í‚·",
                season: "25/26",
                version: "ë ˆí”Œë¦¬ì¹´",
                image: "https://thumblr.uniid.it/product/423995/c2ea5021834c.jpg",
                visible: true,
                site_offers: [
                    {
                        site_name: "Unisport",
                        regular_price: 99.95,
                        sale_price: 99.95,
                        discount_rate: 0,
                        currency: "EUR",
                        affiliate_link: "https://www.unisportstore.com/football-shirts/barcelona-away-shirt-202526-vapor/423995/"
                    }
                ]
            },
            {
                model_code: "HM3193",
                name: "FC Barcelona 2025/26 Third Jersey T90",
                team: "ë°”ë¥´ì…€ë¡œë‚˜",
                kit_type: "ì¨ë“œí‚·",
                season: "25/26",
                version: "ë ˆí”Œë¦¬ì¹´",
                image: "https://thumblr.uniid.it/product/408201/4c1e9beb56df.jpg",
                visible: true,
                site_offers: [
                    {
                        site_name: "Unisport",
                        regular_price: 99.95,
                        sale_price: 99.95,
                        discount_rate: 0,
                        currency: "EUR",
                        affiliate_link: "https://www.unisportstore.com/football-shirts/barcelona-3rd-shirt-202526-vapor/408200/"
                    }
                ]
            }
        ];

        // ì „ì—­ìœ¼ë¡œ í•¨ìˆ˜ ë…¸ì¶œ
        window.addProducts = async function() {
            const statusDiv = document.getElementById('status');
            const detailsDiv = document.getElementById('details');
            const button = document.getElementById('addButton');

            button.disabled = true;
            statusDiv.className = 'status loading';
            statusDiv.textContent = 'ğŸ”„ Firebaseì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ëŠ” ì¤‘...';

            try {
                // í˜„ì¬ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                const uniformRef = ref(database, 'uniformData');
                const snapshot = await get(uniformRef);
                const currentData = snapshot.val() || [];

                console.log('í˜„ì¬ ë°ì´í„° ê°œìˆ˜:', currentData.length);

                // ì¤‘ë³µ ì²´í¬
                const existingCodes = currentData.map(p => p.model_code);
                const duplicates = newProducts.filter(p => existingCodes.includes(p.model_code));

                if (duplicates.length > 0) {
                    statusDiv.className = 'status error';
                    statusDiv.textContent = 'âŒ ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì œí’ˆì´ ìˆìŠµë‹ˆë‹¤';
                    detailsDiv.innerHTML = `<pre>ì¤‘ë³µëœ ëª¨ë¸ ì½”ë“œ: ${duplicates.map(p => p.model_code).join(', ')}</pre>`;
                    button.disabled = false;
                    return;
                }

                statusDiv.textContent = 'âœï¸ Firebaseì— ë°ì´í„° ì¶”ê°€ ì¤‘...';

                // ìƒˆ ì œí’ˆ ì¶”ê°€
                const updatedData = [...currentData, ...newProducts];
                await set(uniformRef, updatedData);

                statusDiv.className = 'status success';
                statusDiv.textContent = 'âœ… ë°”ë¥´ì…€ë¡œë‚˜ 25/26 ìœ ë‹ˆí¼ 3ê°œ ì¶”ê°€ ì™„ë£Œ!';
                detailsDiv.innerHTML = `
                    <h3>ì¶”ê°€ëœ ì œí’ˆ:</h3>
                    <pre>${newProducts.map(p => `${p.model_code} - ${p.name}`).join('\n')}</pre>
                    <p><strong>ì´ ì œí’ˆ ìˆ˜:</strong> ${currentData.length} â†’ ${updatedData.length}</p>
                `;

                console.log('âœ… ì¶”ê°€ ì™„ë£Œ!');
            } catch (error) {
                console.error('âŒ ì˜¤ë¥˜ ë°œìƒ:', error);
                statusDiv.className = 'status error';
                statusDiv.textContent = 'âŒ ì˜¤ë¥˜ ë°œìƒ: ' + error.message;
                detailsDiv.innerHTML = `<pre>${error.stack}</pre>`;
                button.disabled = false;
            }
        };

        // ì´ˆê¸°í™” ì™„ë£Œ
        document.getElementById('status').className = 'status success';
        document.getElementById('status').textContent = 'âœ… Firebase ì—°ê²° ì™„ë£Œ. ì¶”ê°€í•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.';
        document.getElementById('details').innerHTML = `
            <h3>ì¶”ê°€ë  ì œí’ˆ:</h3>
            <ul>
                <li>HJ4590 - FC Barcelona í™ˆí‚· (Unisport, ì‹ ì„¸ê³„ë°±í™”ì )</li>
                <li>HJ4554 - FC Barcelona ì–´ì›¨ì´í‚· Kobe (Unisport)</li>
                <li>HM3193 - FC Barcelona ì¨ë“œí‚· T90 (Unisport)</li>
            </ul>
        `;
        document.getElementById('addButton').disabled = false;

        console.log('âœ… Firebase ì´ˆê¸°í™” ì™„ë£Œ');
    </script>
</body>
</html>
